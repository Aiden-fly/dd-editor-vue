!function(){"use strict";var e=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[e.toolbar?n("div",{staticStyle:{"margin-bottom":"20px"}},[n("tree-header",{attrs:{"use-undo-redo":e.useUndoRedo}})],1):e._e(),e._v(" "),n("node",{attrs:{"data-tree":e.dataTree,"render-content":e.renderContent,"editor-enable":e.editorEnable,"use-undo-redo":e.useUndoRedo}})],1)};e._withStripped=!0;var t,n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dde-node-wraper"},e._l(e.dataTree,(function(t){return n("div",{key:t.id,class:[e.isChild?"dde-tree-childNodes-row":"dde-tree",{"dde-tree-multiply-node":e.dataTree.length>1}]},[n("span",{class:{"dde-tree-node":!0,"dde-tree-leaf-node":t.children.length<=0},staticStyle:{cursor:"pointer"}},[e.editorEnable?n("i",{staticClass:"dde-icon-clear",staticStyle:{cursor:"pointer","margin-right":"5px","font-size":"14px"},on:{click:function(n){return e.onDelete(t)}}}):e._e(),e._v(" "),e.editorEnable?n("node-content",{attrs:{node:t,"use-undo-redo":e.useUndoRedo}}):n("span",[e._v(e._s(t.name))]),e._v(" "),e.editorEnable?n("i",{staticClass:"dde-icon-add",staticStyle:{cursor:"pointer","margin-left":"5px","font-size":"14px"},on:{click:function(n){return e.onAdd(t)}}}):e._e()],1),e._v(" "),t.children.length>0?n("div",{staticClass:"dde-tree-childNodes"},[n("node",{attrs:{"data-tree":t.children,"is-child":!0,"render-content":e.renderContent,"editor-enable":e.editorEnable,"use-undo-redo":e.useUndoRedo}})],1):e._e()])})),0)};n._withStripped=!0;var o=new Uint8Array(16);function r(){if(!t&&!(t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return t(o)}for(var i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,a=function(e){return"string"==typeof e&&i.test(e)},d=[],s=0;s<256;++s)d.push((s+256).toString(16).substr(1));var u=function(e,t,n){var o=(e=e||{}).random||(e.rng||r)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var i=0;i<16;++i)t[n+i]=o[i];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(d[e[t+0]]+d[e[t+1]]+d[e[t+2]]+d[e[t+3]]+"-"+d[e[t+4]]+d[e[t+5]]+"-"+d[e[t+6]]+d[e[t+7]]+"-"+d[e[t+8]]+d[e[t+9]]+"-"+d[e[t+10]]+d[e[t+11]]+d[e[t+12]]+d[e[t+13]]+d[e[t+14]]+d[e[t+15]]).toLowerCase();if(!a(n))throw TypeError("Stringified UUID is invalid");return n}(o)};function c(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function f(e,t,n){return t&&l(e.prototype,t),n&&l(e,n),e}var h=function(){function e(){c(this,e),this.count=0,this.items={}}return f(e,[{key:"size",value:function(){return this.count}},{key:"isEmpty",value:function(){return 0===this.count}},{key:"toEmpty",value:function(){this.count=0,this.items={}}},{key:"push",value:function(e){this.items[this.count]=e,this.count++}},{key:"pop",value:function(){if(!this.isEmpty()){this.count--;var e=this.items[this.count];return delete this.items[this.count],e}}}]),e}();function p(e,t){return(p=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function v(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&p(e,t)}function y(e){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function m(e,t){return!t||"object"!==y(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function b(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=g(e);if(t){var r=g(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return m(this,n)}}var _=function(){function e(t){c(this,e),this.params=t}return f(e,[{key:"undo",value:function(){}},{key:"redo",value:function(){}}]),e}(),k=function(e){v(n,e);var t=b(n);function n(e){var o;return c(this,n),(o=t.call(this,e)).parent=e.parent,o.target={id:e.data.id,name:e.data.name,parentId:e.parent.id,children:[]},o.parent.children.push(o.target),o.target.index=o.parent.children.length-1,o}return f(n,[{key:"undo",value:function(){this.parent.children.pop()}},{key:"redo",value:function(){this.parent.children.push(this.target)}}]),n}(_),S=function(e){v(n,e);var t=b(n);function n(e){var o;return c(this,n),(o=t.call(this,e)).name=e.node.name,o.oldName=e.oldName,o.target=e.node,o}return f(n,[{key:"undo",value:function(){this.target.name=this.oldName}},{key:"redo",value:function(){this.target.name=this.name}}]),n}(_),R=function(e){v(n,e);var t=b(n);function n(e){var o;c(this,n),(o=t.call(this,e)).parent=e.parent,o.target=e.target;for(var r=0;r<o.parent.children.length;r++)if(o.target.id===o.parent.children[r].id){o.parent.children.splice(r,1);break}return o}return f(n,[{key:"undo",value:function(){var e=JSON.parse(JSON.stringify(this.parent.children));if(e.length<=0)this.parent.children.push(this.target);else if(1===e.length)this.target.index>e[0].index?this.parent.children.splice(1,0,this.target):this.parent.children.splice(0,0,this.target);else for(var t=0;t<e.length;t++){if(this.target.index>e[t].index&&this.target.index<e[t+1].index){this.parent.children.splice(t+1,0,this.target);break}if(this.target.index<e[t].index){this.parent.children.splice(t,0,this.target);break}}}},{key:"redo",value:function(){for(var e=0;e<this.parent.children.length;e++)if(this.target.id===this.parent.children[e].id){this.parent.children.splice(e,1);break}}}]),n}(_),C=function(){function e(){c(this,e),this.undoStack=new h,this.redoStack=new h}return f(e,[{key:"save",value:function(e,t){this[e]=t}},{key:"do",value:function(e){this.undoStack.push(e),this.redoStack.toEmpty()}},{key:"undo",value:function(){if(!(this.undoStack.count<=0)){var e=this.undoStack.pop();e.undo(),this.redoStack.push(e)}}},{key:"redo",value:function(){if(!(this.redoStack.count<=0)){var e=this.redoStack.pop();e.redo(),this.undoStack.push(e)}}}]),e}();function w(e,t,n,o,r,i,a,d){var s,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),a?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=s):r&&(s=d?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(u.functional){u._injectStyles=s;var c=u.render;u.render=function(e,t){return s.call(t),c(e,t)}}else{var l=u.beforeCreate;u.beforeCreate=l?[].concat(l,s):[s]}return{exports:e,options:u}}var U=w({name:"Node",components:{NodeContent:{props:{node:{require:!0},useUndoRedo:{require:!0}},render:function(){return this.$parent.renderContent(this.node,this.useUndoRedo,S)}}},props:{dataTree:{type:Array,default:function(){return[]}},isChild:{type:Boolean,default:!1},renderContent:Function,editorEnable:{type:Boolean,default:!1},useUndoRedo:{type:Object,default:function(){}}},mounted:function(){},methods:{onAdd:function(e){console.log("dataTree===",this.dataTree);var t={id:u().replace(/-/g,""),parentId:e.id,name:""};this.useUndoRedo.do(new k({parent:e,data:t}))},onDelete:function(e){for(var t=function(e){var t=[],n=[];for(t=t.concat(e);t.length;){var o=t.shift();o.children&&(t=t.concat(o.children)),n.push(o)}return n}(this.useUndoRedo.data),n=null,o=0;o<t.length;o++)t[o].id===e.parentId&&(n=t[o],t.splice(o,1));this.useUndoRedo.do(new R({parent:n,target:e}))}}},n,[],!1,null,null,null);U.options.__file="packages/dd-treenode/Node.vue";var E=U.exports,x=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-wraper"},[n("i",{class:{"toolbar-icon":!0,"dde-icon-undo":!0,"toolbar-icon-default":e.useUndoRedo.undoStack&&e.useUndoRedo.undoStack.count<=0},on:{click:e.undo}}),e._v(" "),n("i",{class:{"toolbar-icon":!0,"dde-icon-redo":!0,"toolbar-icon-default":e.useUndoRedo.undoStack&&e.useUndoRedo.redoStack.count<=0},on:{click:e.redo}}),e._v(" "),n("i",{staticClass:"toolbar-icon dde-icon-zoomin",on:{click:e.onZoomIn}}),e._v(" "),n("i",{staticClass:"toolbar-icon dde-icon-zoomout",on:{click:e.onZoomOut}})])};x._withStripped=!0;var O=w({name:"TreeHeader",props:{useUndoRedo:{type:Object,default:function(){}}},data:function(){return{scaleCount:1}},mounted:function(){},methods:{setZoom:function(e,t){e.$el.setAttribute("style","transform:scale(".concat(t,");transform-origin:left top;"))},changeSize:function(e){switch(e.type){case"increment":var t=this.scaleCount+.1;this.setZoom(e.ref,t),this.scaleCount=t;break;case"decrement":var n=this.scaleCount-.1;n<=.1&&(this.scaleCount=.1),this.setZoom(e.ref,n),this.scaleCount=n;break;default:throw new Error}},onZoomIn:function(){this.changeSize({type:"increment",ref:this.$parent.$children[1]})},onZoomOut:function(){this.changeSize({type:"decrement",ref:this.$parent.$children[1]})},undo:function(){this.useUndoRedo.undo()},redo:function(){this.useUndoRedo.redo()}}},x,[],!1,null,"d09e9d1a",null);O.options.__file="packages/dd-treenode/Header.vue";var T=w({name:"DdTreenode",componentName:"ddTreenode",components:{Node:E,treeHeader:O.exports},props:{dataTree:{type:Array,default:function(){return[]}},renderContent:Function,editorEnable:{type:Boolean,default:!1},toolbar:{type:Boolean,default:!1}},data:function(){return{useUndoRedo:{}}},mounted:function(){this.useUndoRedo=new C,console.log("this.useUndoRedo===",this.useUndoRedo),this.useUndoRedo.save("data",this.dataTree)}},e,[],!1,null,"0f2045fc",null);T.options.__file="packages/dd-treenode/index.vue";var $=T.exports;$.install=function(e){e.component($.name,$)};var N,j=[$];"undefined"!=typeof window&&window.Vue&&(N=window.Vue,j.forEach((function(e){N.component(e.name,e)})))}();
//# sourceMappingURL=main.js.map