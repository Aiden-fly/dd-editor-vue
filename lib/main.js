!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("dd-editor",[],t):"object"==typeof exports?exports["dd-editor"]=t():e["dd-editor"]=t()}(self,(function(){return function(){"use strict";var e=function(e,t,n){n.d(t,{default:function(){return j}});var r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[n("node",{attrs:{dataTree:e.treeData,"render-content":e.renderContent}})],1)};r._withStripped=!0;var o,i=JSON.parse('[{"id":0,"parentId":-1,"name":"node","type":1,"children":[{"id":1,"parentId":0,"name":"node1","type":2,"children":[{"id":111,"parentId":1,"name":"node111","type":3},{"id":112,"parentId":1,"name":"node112","type":4}]}]}]'),a=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"node-wraper"},e._l(e.dataTree,(function(t){return n("div",{key:t.id,class:[e.isChild?"tree-childNodes-row":"tree-root",{"multiply-node":e.dataTree.length>1}]},[n("span",{class:{"tree-node":!0,"leaf-node":!t.children}},[n("span",{on:{click:function(n){return e.onDelete(t)}}},[e._v("-")]),e._v(" "),n("node-content",{attrs:{node:t}}),e._v(" "),n("span",{on:{click:function(n){return e.onAdd(t)}}},[e._v("+")])],1),e._v(" "),t.children?n("div",{staticClass:"tree-childNodes"},[n("node",{attrs:{dataTree:t.children,isChild:!0,"render-content":e.renderContent}})],1):e._e()])})),0)};a._withStripped=!0;var d=new Uint8Array(16);function s(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(d)}var c=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var u=function(e){return"string"==typeof e&&c.test(e)},f=[],p=0;p<256;++p)f.push((p+256).toString(16).substr(1));var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(f[e[t+0]]+f[e[t+1]]+f[e[t+2]]+f[e[t+3]]+"-"+f[e[t+4]]+f[e[t+5]]+"-"+f[e[t+6]]+f[e[t+7]]+"-"+f[e[t+8]]+f[e[t+9]]+"-"+f[e[t+10]]+f[e[t+11]]+f[e[t+12]]+f[e[t+13]]+f[e[t+14]]+f[e[t+15]]).toLowerCase();if(!u(n))throw TypeError("Stringified UUID is invalid");return n};var h=function(e,t,n){var r=(e=e||{}).random||(e.rng||s)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=r[o];return t}return l(r)};function v(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function m(e,t){var n=JSON.parse(JSON.stringify(e)),r={},o=[];n.forEach((function(e){r[e.id]=e}));for(var i=0,a=n.length;i<a;i++){var d=n[i].parentId;d===t?o.push(n[i]):r[d].children?r[d].children.push(n[i]):r[d].children=[n[i]]}return o}var y,g,_,S,b,C=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.count=0,this.items={}}var t,n,r;return t=e,(n=[{key:"size",value:function(){return this.count}},{key:"isEmpty",value:function(){return 0===this.count}},{key:"push",value:function(e){this.items[this.count]=e,this.count++}},{key:"pop",value:function(){if(!this.isEmpty()){this.count--;var e=this.items[this.count];return delete this.items[this.count],e}}}])&&v(t.prototype,n),r&&v(t,r),e}(),w=(y={},{subscribe:function(e,t){void 0===y[e]?y[e]=[t]:y[e].push(t)},unSubScribe:function(e,t){if(y[e]instanceof Array)for(var n=y[e].length-1;n>=0;n--)y[e][n]===t&&y[e].splice(n,1)},dispatch:function(e,t){if(y[e])for(var n={type:e,args:t||{}},r=0;r<y[e].length;r++)y[e][r].call(this,n)}}),N=(g=[],_=new C,S=new C,b={init:function(e){g=function(e){var t=[],n=[];for(t=t.concat(e);t.length;){var r=t.shift();r.children&&(t=t.concat(r.children),delete r.children),n.push(r)}return n}(g=JSON.parse(JSON.stringify(Object.assign([],e))))},add:function(e){var t=JSON.parse(JSON.stringify(g));_.push(t),console.log("undoStack=",_),g.push(e),b.retrieve()},update:function(e){var t=JSON.parse(JSON.stringify(g)).map((function(t){return t.id===e.id?e:t}));g=function(e){for(var t=0;t<e.length;t++)for(var n=n+1;n<e.length;n++)e[t].id===e[n].id&&(e.splice(n,1),n--);return e}(t),b.retrieve()},delete:function(e){var t=JSON.parse(JSON.stringify(g));_.push(t);var n=function(e,t){var n=[],r=[];for(n=n.concat(e);n.length;){var o=n.shift();o.id!==t.id&&(o.children&&(n=n.concat(o.children),delete o.children),r.push(o))}return r}(m(g,-1),e);g=n,b.retrieve()},undo:function(){if(!_.isEmpty()){var e=JSON.parse(JSON.stringify(g));S.push(e),g=_.pop(),b.retrieve()}},redo:function(){if(!S.isEmpty()){var e=JSON.parse(JSON.stringify(g));_.push(e),g=S.pop(),b.retrieve()}},retrieve:function(){var e=m(g,-1);return w.dispatch("tree",{msg:e}),e}},{excute:function(e){if(e)if(e.length)for(var t=0;t<e.length;t++)this(e[t]);else b[e.command].call(b,e.param)},stack:{undoStack:_,redoStack:S}}),O=function(e){e.children&&delete e.children,N.excute({command:"update",param:e})};function x(e,t,n,r,o,i,a,d){var s,c="function"==typeof e?e.options:e;if(t&&(c.render=t,c.staticRenderFns=n,c._compiled=!0),r&&(c.functional=!0),i&&(c._scopeId="data-v-"+i),a?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),o&&o.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},c._ssrRegister=s):o&&(s=d?function(){o.call(this,(c.functional?this.parent:this).$root.$options.shadowRoot)}:o),s)if(c.functional){c._injectStyles=s;var u=c.render;c.render=function(e,t){return s.call(t),u(e,t)}}else{var f=c.beforeCreate;c.beforeCreate=f?[].concat(f,s):[s]}return{exports:e,options:c}}var E=x({name:"node",props:{dataTree:{type:Array,default:function(){return[]}},isChild:{type:Boolean,default:!1},renderContent:Function},components:{NodeContent:{props:{node:{require:!0}},render:function(){return this.$parent.renderContent(this.node,O)}}},mounted:function(){},methods:{onAdd:function(e){var t={id:h().replace(/-/g,""),parentId:e.id,name:h().replace(/-/g,"")};N.excute({command:"add",param:t})},onDelete:function(e){N.excute({command:"delete",param:e})}}},a,[],!1,null,"618b15e8",null);E.options.__file="packages/dd-treenode/Node.vue";var J=E.exports,k=x({name:"dd-treenode",props:{dataTree:{type:Array,default:function(){return i}},renderContent:Function},data:function(){return{treeData:this.dataTree}},components:{Node:J},mounted:function(){var e=this;N.excute({command:"init",param:this.dataTree}),w.subscribe("tree",(function(t){e.treeData=t.args.msg}))}},r,[],!1,null,"0f2045fc",null);k.options.__file="packages/dd-treenode/index.vue";var T=k.exports;T.install=function(e){e.component(T.name,T)};var R=[T],$=function(e){R.forEach((function(t){e.component(t.name,t)}))};"undefined"!=typeof window&&window.Vue&&$(window.Vue);var j={install:$,version:"0.0.1"}},t={d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},n={};return e(0,n,t),n=n.default}()}));
//# sourceMappingURL=main.js.map