!function(){"use strict";var e={d:function(t,n){for(var o in n)e.o(n,o)&&!e.o(t,o)&&Object.defineProperty(t,o,{enumerable:!0,get:n[o]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},t={};e.d(t,{default:function(){return I}});var n=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"wrapper"},[e.toolbar?n("div",{staticStyle:{"margin-bottom":"20px"}},[n("tree-header",{attrs:{"use-undo-redo":e.useUndoRedo}})],1):e._e(),e._v(" "),n("node",{attrs:{"data-tree":e.dataTree,"render-content":e.renderContent,"editor-enable":e.editorEnable,"use-undo-redo":e.useUndoRedo}})],1)};n._withStripped=!0;var o,r=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"dde-node-wraper"},e._l(e.dataTree,(function(t){return n("div",{key:t.id,class:[e.isChild?"dde-tree-childNodes-row":"dde-tree",{"dde-tree-multiply-node":e.dataTree.length>1}]},[n("span",{class:{"dde-tree-node":!0,"dde-tree-leaf-node":t.children.length<=0},staticStyle:{cursor:"pointer"}},[e.editorEnable?n("i",{staticClass:"dde-icon-clear",staticStyle:{cursor:"pointer","margin-right":"5px","font-size":"14px"},on:{click:function(n){return e.onDelete(t)}}}):e._e(),e._v(" "),e.editorEnable?n("node-content",{attrs:{node:t,"use-undo-redo":e.useUndoRedo}}):n("span",[e._v(e._s(t.name))]),e._v(" "),e.editorEnable?n("i",{staticClass:"dde-icon-add",staticStyle:{cursor:"pointer","margin-left":"5px","font-size":"14px"},on:{click:function(n){return e.onAdd(t)}}}):e._e()],1),e._v(" "),t.children.length>0?n("div",{staticClass:"dde-tree-childNodes"},[n("node",{attrs:{"data-tree":t.children,"is-child":!0,"render-content":e.renderContent,"editor-enable":e.editorEnable,"use-undo-redo":e.useUndoRedo}})],1):e._e()])})),0)};r._withStripped=!0;var i=new Uint8Array(16);function a(){if(!o&&!(o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return o(i)}for(var d=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,s=function(e){return"string"==typeof e&&d.test(e)},u=[],c=0;c<256;++c)u.push((c+256).toString(16).substr(1));var l=function(e,t,n){var o=(e=e||{}).random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t){n=n||0;for(var r=0;r<16;++r)t[n+r]=o[r];return t}return function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(u[e[t+0]]+u[e[t+1]]+u[e[t+2]]+u[e[t+3]]+"-"+u[e[t+4]]+u[e[t+5]]+"-"+u[e[t+6]]+u[e[t+7]]+"-"+u[e[t+8]]+u[e[t+9]]+"-"+u[e[t+10]]+u[e[t+11]]+u[e[t+12]]+u[e[t+13]]+u[e[t+14]]+u[e[t+15]]).toLowerCase();if(!s(n))throw TypeError("Stringified UUID is invalid");return n}(o)};function f(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function p(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function h(e,t,n){return t&&p(e.prototype,t),n&&p(e,n),e}var v=function(){function e(){f(this,e),this.count=0,this.items={}}return h(e,[{key:"size",value:function(){return this.count}},{key:"isEmpty",value:function(){return 0===this.count}},{key:"toEmpty",value:function(){this.count=0,this.items={}}},{key:"push",value:function(e){this.items[this.count]=e,this.count++}},{key:"pop",value:function(){if(!this.isEmpty()){this.count--;var e=this.items[this.count];return delete this.items[this.count],e}}}]),e}();function y(e,t){return(y=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function m(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&y(e,t)}function g(e){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e,t){return!t||"object"!==g(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _(e){return(_=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function k(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=_(e);if(t){var r=_(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return b(this,n)}}var S=function(){function e(t){f(this,e),this.params=t}return h(e,[{key:"undo",value:function(){}},{key:"redo",value:function(){}}]),e}(),R=function(e){m(n,e);var t=k(n);function n(e){var o;return f(this,n),(o=t.call(this,e)).parent=e.parent,o.target={id:e.data.id,name:e.data.name,parentId:e.parent.id,children:[]},o.parent.children.push(o.target),o.target.index=o.parent.children.length-1,o}return h(n,[{key:"undo",value:function(){this.parent.children.pop()}},{key:"redo",value:function(){this.parent.children.push(this.target)}}]),n}(S),w=function(e){m(n,e);var t=k(n);function n(e){var o;return f(this,n),(o=t.call(this,e)).name=e.node.name,o.oldName=e.oldName,o.target=e.node,o}return h(n,[{key:"undo",value:function(){this.target.name=this.oldName}},{key:"redo",value:function(){this.target.name=this.name}}]),n}(S),C=function(e){m(n,e);var t=k(n);function n(e){var o;f(this,n),(o=t.call(this,e)).parent=e.parent,o.target=e.target;for(var r=0;r<o.parent.children.length;r++)if(o.target.id===o.parent.children[r].id){o.parent.children.splice(r,1);break}return o}return h(n,[{key:"undo",value:function(){var e=JSON.parse(JSON.stringify(this.parent.children));if(e.length<=0)this.parent.children.push(this.target);else if(1===e.length)this.target.index>e[0].index?this.parent.children.splice(1,0,this.target):this.parent.children.splice(0,0,this.target);else for(var t=0;t<e.length;t++){if(this.target.index>e[t].index&&this.target.index<e[t+1].index){this.parent.children.splice(t+1,0,this.target);break}if(this.target.index<e[t].index){this.parent.children.splice(t,0,this.target);break}}}},{key:"redo",value:function(){for(var e=0;e<this.parent.children.length;e++)if(this.target.id===this.parent.children[e].id){this.parent.children.splice(e,1);break}}}]),n}(S),U=function(){function e(){f(this,e),this.undoStack=new v,this.redoStack=new v}return h(e,[{key:"save",value:function(e,t){this[e]=t}},{key:"do",value:function(e){this.undoStack.push(e),this.redoStack.toEmpty()}},{key:"undo",value:function(){if(!(this.undoStack.count<=0)){var e=this.undoStack.pop();e.undo(),this.redoStack.push(e)}}},{key:"redo",value:function(){if(!(this.redoStack.count<=0)){var e=this.redoStack.pop();e.redo(),this.undoStack.push(e)}}}]),e}();function E(e,t,n,o,r,i,a,d){var s,u="function"==typeof e?e.options:e;if(t&&(u.render=t,u.staticRenderFns=n,u._compiled=!0),o&&(u.functional=!0),i&&(u._scopeId="data-v-"+i),a?(s=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),r&&r.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(a)},u._ssrRegister=s):r&&(s=d?function(){r.call(this,(u.functional?this.parent:this).$root.$options.shadowRoot)}:r),s)if(u.functional){u._injectStyles=s;var c=u.render;u.render=function(e,t){return s.call(t),c(e,t)}}else{var l=u.beforeCreate;u.beforeCreate=l?[].concat(l,s):[s]}return{exports:e,options:u}}var x=E({name:"Node",components:{NodeContent:{props:{node:{require:!0},useUndoRedo:{require:!0}},render:function(){return this.$parent.renderContent(this.node,this.useUndoRedo,w)}}},props:{dataTree:{type:Array,default:function(){return[]}},isChild:{type:Boolean,default:!1},renderContent:Function,editorEnable:{type:Boolean,default:!1},useUndoRedo:{type:Object,default:function(){}}},mounted:function(){},methods:{onAdd:function(e){console.log("dataTree===",this.dataTree);var t={id:l().replace(/-/g,""),parentId:e.id,name:""};this.useUndoRedo.do(new R({parent:e,data:t}))},onDelete:function(e){for(var t=function(e){var t=[],n=[];for(t=t.concat(e);t.length;){var o=t.shift();o.children&&(t=t.concat(o.children)),n.push(o)}return n}(this.useUndoRedo.data),n=null,o=0;o<t.length;o++)t[o].id===e.parentId&&(n=t[o],t.splice(o,1));this.useUndoRedo.do(new C({parent:n,target:e}))}}},r,[],!1,null,null,null);x.options.__file="packages/dd-treenode/Node.vue";var O=x.exports,T=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-wraper"},[n("i",{class:{"toolbar-icon":!0,"dde-icon-undo":!0,"toolbar-icon-default":e.useUndoRedo.undoStack&&e.useUndoRedo.undoStack.count<=0},on:{click:e.undo}}),e._v(" "),n("i",{class:{"toolbar-icon":!0,"dde-icon-redo":!0,"toolbar-icon-default":e.useUndoRedo.undoStack&&e.useUndoRedo.redoStack.count<=0},on:{click:e.redo}}),e._v(" "),n("i",{staticClass:"toolbar-icon dde-icon-zoomin",on:{click:e.onZoomIn}}),e._v(" "),n("i",{staticClass:"toolbar-icon dde-icon-zoomout",on:{click:e.onZoomOut}})])};T._withStripped=!0;var $=E({name:"TreeHeader",props:{useUndoRedo:{type:Object,default:function(){}}},data:function(){return{scaleCount:1}},mounted:function(){},methods:{setZoom:function(e,t){e.$el.setAttribute("style","transform:scale(".concat(t,");transform-origin:left top;"))},changeSize:function(e){switch(e.type){case"increment":var t=this.scaleCount+.1;this.setZoom(e.ref,t),this.scaleCount=t;break;case"decrement":var n=this.scaleCount-.1;n<=.1&&(this.scaleCount=.1),this.setZoom(e.ref,n),this.scaleCount=n;break;default:throw new Error}},onZoomIn:function(){this.changeSize({type:"increment",ref:this.$parent.$children[1]})},onZoomOut:function(){this.changeSize({type:"decrement",ref:this.$parent.$children[1]})},undo:function(){this.useUndoRedo.undo()},redo:function(){this.useUndoRedo.redo()}}},T,[],!1,null,"d09e9d1a",null);$.options.__file="packages/dd-treenode/Header.vue";var N=E({name:"DdTreenode",componentName:"ddTreenode",components:{Node:O,treeHeader:$.exports},props:{dataTree:{type:Array,default:function(){return[]}},renderContent:Function,editorEnable:{type:Boolean,default:!1},toolbar:{type:Boolean,default:!1}},data:function(){return{useUndoRedo:{}}},mounted:function(){this.useUndoRedo=new U,console.log("this.useUndoRedo===",this.useUndoRedo),this.useUndoRedo.save("data",this.dataTree)}},n,[],!1,null,"0f2045fc",null);N.options.__file="packages/dd-treenode/index.vue";var j=N.exports;j.install=function(e){e.component(j.name,j)};var V=j,z=[V],P=function(e){z.forEach((function(t){e.component(t.name,t)}))};"undefined"!=typeof window&&window.Vue&&P(window.Vue);var I={install:P,ddTreenode:V,version:"1.0.6"};module.exports=t.default}();
//# sourceMappingURL=dd-editor-common.js.map